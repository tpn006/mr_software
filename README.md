# MR Software (CSE185 Spring 2023 Final Project)

CSE 185 Spring 2023 Final Project: MOTIF Recognition Software (MR Software)

This is the final project for group 18 for CSE 185 Spring 2023. The goal of the tool is to find which motifs are enriched in peaks. The tool takes a list of peak locations, a reference genome, and the motifs to check for enrichment. This tool is meant to replicate HOMERs known motif recognition but on a smaller scale using supplied known motifs. 

# Install instructions

As of now, our tool cannot be installed and must be ran as a python program. This is a work in progress and will be able to be installed at a later date. Running requires the `pyfaidx` library to be installed. You can install `pyfaidx` with `pip`:

```
pip install pyfaidx 
```


# Basic usage

The basic usage of `mrsoftware` is:
```
python3 mrsoftware.py -m "Path to the .meme file containing motif information" -g "Path to the .fa file containing the reference genome" "Path to the .bed file containing peak information"
```

Another option is to install `mrsoftware`. This is done by using `setuptools`. You can verify if `setuptools` is installed correctly by using _____. Otherwise, you can install `setuptools` though ________ for python2 or ______ for python3. This allows you to use the command `python3 setup.py install` followed by `chmod +x mrsoftware` allowing the user to use `mrsoftware` through commandline. ex: ```mrsoftware -m <path to meme file> -g <path to genome> <path to bed>``` 

To run `mrsoftware` on a small test example (using files in this repo):
* copy GRCm38.fa to /MR_SOFTWARE/tests/ (this file is very large ~2.6GB so not stored on github. We recommend: https://www.ncbi.nlm.nih.gov/assembly/GCF_000001635.20/)
* go to the directory /MR_SOFTWARE/mrsoftware/
* run: 
```
python3 mrsoftware.py -m "../tests/short.meme" -g "../tests/GRCm38.chr17.fa" "../tests/short.bed"
```

After running this line, there will be live feedback in the terminal as it runs, as well as a newly created file called testing.txt. The values within the txt file may vary slightly due to the randomness of generating background sequences, but it will be similar to the following lines:

```
Initializing by checking argument validity
There are 82 peaks. 
There are 20 known motifs.
MOTIF: PO5F1_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: AHR_MOUSE.H11MO.0.B threshold score: 0.0
MOTIF: AIRE_MOUSE.H11MO.0.C threshold score: 0.0
MOTIF: ALX1_MOUSE.H11MO.0.B threshold score: 0.0
MOTIF: ANDR_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: AP2A_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: AP2B_MOUSE.H11MO.0.B threshold score: 0.0
MOTIF: AP2C_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: ARI5B_MOUSE.H11MO.0.C threshold score: 0.0
MOTIF: ARNT_MOUSE.H11MO.0.B threshold score: 0.0
MOTIF: ASCL1_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: ASCL2_MOUSE.H11MO.0.C threshold score: 0.0
MOTIF: ATF1_MOUSE.H11MO.0.B threshold score: 0.0
MOTIF: ATF2_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: ATF3_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: ATF4_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: ATOH1_MOUSE.H11MO.0.B threshold score: 0.0
MOTIF: BACH1_MOUSE.H11MO.0.C threshold score: 0.0
MOTIF: BACH2_MOUSE.H11MO.0.A threshold score: 0.0
MOTIF: BARX1_MOUSE.H11MO.0.C threshold score: 0.0
DONE :)
```

To compare to the output of `homer`, run:
* go to the tests directory
* run 

```
mkdir HOMER

bed2pos short.bed > short.txt

findMotifsGenome.pl short.txt GRCm38.fa HOMER 
```

# mrsoftware options

`mrsoftware.py` requires 3 inputs: 
* `-g` followed by a reference genome in .fa format. 
* `-m` followed by a file containing motif information in a .meme format.
* and lastly a file containing peak information in a .bed format.

There is one optional input as of now:
* `-o` an output file to write output to. If the option is not used, the tool uses the default which is sysout

# File format

The output file format is a .txt with the motifs ranked in descending order of enrichment significance.

# Contributors

This repository was generated by Tasha Nguyen and Jonathan Narita, following the example project for CSE 185 Spring 2023 made by Melissa Gymrek and inspired by HOMER, which was developed by Chris Benner and other individuals.